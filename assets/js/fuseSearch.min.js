"use strict";self.onmessage=function(a){switch(a.data.type){case"init":importScripts("../lib/fuse/fuse.min.js"),self.workerSearchThrothlePeriod=a.data.data.workerSearchThrothlePeriod,self.maxResultLength=a.data.data.maxResultLength,self.highlightTag=a.data.data.highlightTag,self._index=new Fuse(a.data.data.data,a.data.data.options);break;case"search":searchWithTimeout(a.data.data.query);}};var timeout=void 0,searchWithTimeout=function(a){clearTimeout(timeout),timeout=setTimeout(function(){postMessage(search(a))},workerSearchThrothlePeriod)},search=function(a){var b=[],c=self._index.search(a);0<c.length&&!!c[0].matches&&(c.forEach(function(a){a.matches.sort(function(c,a){return c.indices[0][2]-a.indices[0][2]})}),c.sort(function(c,a){var b=c.matches[0].indices[0][2]-a.matches[0].indices[0][2];return 0==b?c.score-a.score:b}));for(var d=function(a){var d=c[a],e=d.item,f=d.matches,g=e.title,h=e.content,i=h.length;f.forEach(function(a){var b=a.indices,c=a.key;if("content"===c){var o=0;b[0][0]<i&&(i=b[0][0]);for(var d=0,e=0;e<b.length;e++){if(b[e][0]<d){b[e][1]>d&&(d=b[e][1]);continue}d=b[e][1];var f=h.substring(b[e][0]+o,b[e][1]+1+o),j="<".concat(highlightTag,">")+f+"</".concat(highlightTag,">");h=h.substring(0,b[e][0]+o)+j+h.substring(b[e][1]+1+o,h.length),o+=2*highlightTag.length+5}}else if("title"===c)for(var k=0,l=0;l<b.length;l++){var m=g.substring(b[l][0]+k,b[l][1]+1+k),n="<".concat(highlightTag,">")+m+"</".concat(highlightTag,">");g=g.substring(0,b[l][0]+k)+n+g.substring(b[l][1]+1+k,h.length),k+=2*highlightTag.length+5}}),19<i&&(h="..."+h.substr(i-15)),b.push({uri:e.uri,title:g,date:e.date,context:h})},e=0;e<Math.min(c.length,maxResultLength);e++)d(e);return b};

//# sourceMappingURL=fuseSearch.min.js.map